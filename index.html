<!-- Save as index.html (replace your existing index.html) -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CampuSphere ‚Äî Campus Navigator + SLMs</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800;900&display=swap" rel="stylesheet" />
  <style>
    body { font-family: 'Inter', sans-serif; }
    .nav-link-glow { transition: transform .2s, background-color .2s, color .2s; }
    .nav-link-glow:hover { transform: scale(1.03); background-color: #facc15; color:#000; }
    .badge-pill { background: linear-gradient(90deg,#f59e0b,#f97316); color: white; padding: .25rem .6rem; border-radius:999px; font-weight:700 }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">

  <header class="bg-yellow-50 shadow-md flex justify-between items-center w-full px-6 py-4 sticky top-0 z-50">
    <div class="flex items-center space-x-3">
      <img src="Screenshot 2025-09-10 132615.png" alt="CampuSphere" class="w-12 h-12 object-contain" />
      <div>
        <h1 class="text-2xl font-bold">CampuSphere</h1>
        <div class="text-xs text-gray-500">MUJ Campus Guide + SLMs</div>
      </div>
    </div>

    <nav class="flex items-center space-x-3">
      <button id="open-map" class="nav-link-glow px-4 py-2 border border-yellow-600 text-yellow-600 rounded-full text-sm font-semibold">Open Map</button>
      <button id="open-slm" class="nav-link-glow px-4 py-2 border border-yellow-600 text-yellow-600 rounded-full text-sm font-semibold">SLMs</button>
      <a href="#footer" class="nav-link-glow px-4 py-2 border border-yellow-600 text-yellow-600 rounded-full text-sm font-semibold">FAQ</a>
    </nav>
  </header>

  <!-- HERO -->
  <main class="min-h-screen">
    <section class="relative bg-yellow-700 text-white flex items-center justify-center p-12" style="background-image:url('https://websiteupload.s3.ap-south-1.amazonaws.com/2024/05/manipal-uni.jpg'); background-size:cover;">
      <div class="absolute inset-0 bg-yellow-900 opacity-70"></div>
      <div class="relative z-10 max-w-4xl text-center">
        <h2 class="text-4xl font-extrabold">Welcome Freshers ‚Äî Navigate. Learn. Belong.</h2>
        <p class="mt-4">CampuSphere combines geolocated navigation with micro SLMs to teach new students campus life essentials.</p>
        <div class="mt-6 flex justify-center gap-3">
          <button id="start-first-week" class="bg-white text-yellow-700 px-5 py-3 rounded-full font-semibold hover:bg-gray-100">Start First-Week Pathway</button>
          <button id="view-hacks" class="bg-green-600 text-white px-5 py-3 rounded-full font-semibold hover:bg-green-700">Campus Hacks</button>
        </div>
      </div>
    </section>

    <!-- CORE: SLMs + Hacks + Quick Links -->
    <section class="py-12 px-6 max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Left: SLM list / pathway -->
      <div class="col-span-2 bg-white p-6 rounded-xl shadow">
        <div class="flex items-center justify-between">
          <h3 class="text-2xl font-bold">Structured Learning Modules (SLMs)</h3>
          <div>
            <span class="badge-pill" id="badge-slot" style="display:none">üèÖ Badge earned</span>
          </div>
        </div>
        <p class="text-sm text-gray-600 mt-2">Short scaffolded lessons about campus systems. Cached for offline access.</p>

        <!-- Pathway -->
        <div class="mt-6">
          <h4 class="font-semibold">Guided Pathway: First Week</h4>
          <ol id="pathway" class="mt-3 list-decimal list-inside space-y-3 text-gray-700"></ol>
        </div>

        <!-- SLM content panel -->
        <div id="slm-panel" class="mt-6 border rounded p-4 hidden">
          <div id="slm-title" class="text-xl font-bold"></div>
          <div id="slm-body" class="mt-2 text-gray-700"></div>

          <!-- Quiz area (one interactive quiz example) -->
          <div id="quiz-area" class="mt-4 bg-gray-50 p-3 rounded hidden">
            <div id="quiz-question" class="font-semibold"></div>
            <div id="quiz-choices" class="mt-3 space-y-2"></div>
            <div class="mt-3">
              <button id="submit-quiz" class="bg-yellow-600 text-white px-4 py-2 rounded">Submit</button>
            </div>
            <div id="quiz-feedback" class="mt-3 text-sm"></div>
          </div>

          <div class="mt-4 flex gap-2">
            <button id="prev-slm" class="px-3 py-2 border rounded">Previous</button>
            <button id="next-slm" class="px-3 py-2 bg-yellow-600 text-white rounded">Next</button>
            <button id="cache-this" class="px-3 py-2 border rounded">Cache for offline</button>
            <button id="open-map-from-slm" class="px-3 py-2 border rounded">Find Help on Map</button>
          </div>
        </div>
      </div>

      <!-- Right: Hacks + Mentors -->
      <div class="bg-white p-6 rounded-xl shadow">
        <h4 class="text-xl font-bold">Campus Hacks (Peer)</h4>
        <p class="text-sm text-gray-600 mt-1">Quick tips from students.</p>
        <ul id="hacks-list" class="mt-3 space-y-3 text-gray-700"></ul>

        <div class="mt-6">
          <h4 class="text-lg font-semibold">Share a Hack</h4>
          <input id="hack-input" class="w-full border p-2 rounded mt-2" placeholder="e.g., Best place to charge laptop" />
          <button id="submit-hack" class="w-full mt-2 bg-green-600 text-white py-2 rounded">Share</button>
        </div>

        <div class="mt-6">
          <h4 class="text-lg font-semibold">Mentor Micro-Sessions</h4>
          <p class="text-sm text-gray-600">Tap a mentor on the map for quick sessions.</p>
          <ul id="mentors" class="mt-2 space-y-2 text-gray-700"></ul>
        </div>
      </div>
    </section>

    <!-- Quick footer CTA -->
    <section class="max-w-6xl mx-auto p-6">
      <div class="bg-white p-4 rounded shadow text-center">
        <strong>Tip:</strong> Use the "Cache for offline" button on any SLM to store it on your device for offline reading.
      </div>
    </section>
  </main>

  <footer id="footer" class="bg-gray-900 text-gray-300 py-8 px-6">
    <div class="max-w-6xl mx-auto text-center">
      ¬© 2025 CampuSphere ‚Äî MUJ Campus Guide. Built for PBL.
    </div>
  </footer>

  <!-- SCRIPTS: SLMs + navigation + offline caching -->
  <script>
    // ---- Basic data: SLMs, pathway, mentor points, hacks ----
    const DEFAULT_SLMs = [
      { id: 'lib', title: 'Library Basics', body: '<p>How to search the catalogue, borrow books, and use study rooms.</p>', helpPoint: {lat:26.885, lng:75.77}},
      { id: 'exam', title: 'Exam Rules & Tips', body: '<p>Major rules, seating, and time management tips.</p>' },
      { id: 'hostel', title: 'Hostel Guidelines', body: '<p>Entry/exit, mess rules, and quiet hours.</p>' },
      { id: 'lab', title: 'Lab Safety', body: '<p>Mandatory rules, PPE, and emergency contacts.</p>',
        quiz: {
          q: 'What should you wear in a chemistry lab to protect your eyes?',
          choices: ['Open-toe sandals', 'Safety goggles', 'Sunglasses'],
          answerIndex: 1,
          badge: 'lab-safety'
        }
      }
    ];

    const FIRST_WEEK_PATH = ['lib','hostel','exam'];

    // mentors shown on map (map will read this later)
    const MENTORS = [
      {id:'m1', name:'Asha (CS Senior)', lat:26.8854, lng:75.7712, topic:'Hostel tips, enrollment'},
      {id:'m2', name:'Ravi (Library Rep)', lat:26.8848, lng:75.7696, topic:'Library orientation'}
    ];

    // load SLMs (from localStorage fallback to defaults)
    function loadSLMs(){
      try {
        const raw = localStorage.getItem('slms_v1');
        if(raw) return JSON.parse(raw);
      } catch(e){}
      // if not present, seed defaults and cache
      localStorage.setItem('slms_v1', JSON.stringify(DEFAULT_SLMs));
      return DEFAULT_SLMs;
    }

    const SLMs = loadSLMs();

    // pathway render
    function renderPathway(){
      const ol = document.getElementById('pathway');
      ol.innerHTML = '';
      FIRST_WEEK_PATH.forEach((id, idx) => {
        const slm = SLMs.find(s=>s.id===id);
        if(!slm) return;
        const li = document.createElement('li');
        li.innerHTML = `<div class="flex justify-between items-start"><div><strong>${slm.title}</strong><div class="text-xs text-gray-500">${slm.id}</div></div><div><button class="px-3 py-1 text-sm border rounded view-slm" data-id="${slm.id}">Open</button></div></div>`;
        ol.appendChild(li);
      });
    }

    // hacks rendering
    function loadHacks(){
      try {
        return JSON.parse(localStorage.getItem('hacks_v1')||'[]');
      } catch(e){ return []; }
    }
    function renderHacks(){
      const ul = document.getElementById('hacks-list');
      const hacks = loadHacks();
      ul.innerHTML = hacks.length ? hacks.map(h=>`<li class="p-2 bg-gray-50 rounded">${h}</li>`).join('') : '<li class="text-sm text-gray-500">No hacks yet ‚Äî be the first!</li>';
    }

    // mentors render
    function renderMentors(){
      const node = document.getElementById('mentors');
      node.innerHTML = MENTORS.map(m=>`<li class="p-2 bg-gray-50 rounded"><strong>${m.name}</strong><div class="text-xs text-gray-600">${m.topic}</div></li>`).join('');
    }

    // SLM panel controls
    let currentSlmIndex = 0;
    function showSlmById(id){
      const idx = SLMs.findIndex(s=>s.id===id);
      if(idx>=0) showSlm(idx);
    }
    function showSlm(idx){
      currentSlmIndex = idx;
      const slm = SLMs[idx];
      if(!slm) return;
      document.getElementById('slm-panel').style.display='block';
      document.getElementById('slm-title').innerHTML = slm.title;
      document.getElementById('slm-body').innerHTML = slm.body;
      // quiz handling
      if(slm.quiz){
        document.getElementById('quiz-area').style.display='block';
        document.getElementById('quiz-question').innerText = slm.quiz.q;
        const container = document.getElementById('quiz-choices');
        container.innerHTML = '';
        slm.quiz.choices.forEach((c,i)=> {
          const id = `choice-${i}`;
          const div = document.createElement('div');
          div.innerHTML = `<label class="flex items-center gap-2"><input type="radio" name="quiz" value="${i}" /> <span>${c}</span></label>`;
          container.appendChild(div);
        });
      } else {
        document.getElementById('quiz-area').style.display='none';
      }
    }

    function nextSlm(){
      if(currentSlmIndex < SLMs.length-1) showSlm(currentSlmIndex+1);
    }
    function prevSlm(){ if(currentSlmIndex>0) showSlm(currentSlmIndex-1); }

    // quiz submit
    document.addEventListener('click', function(e){
      if(e.target && e.target.id === 'submit-quiz'){
        const slm = SLMs[currentSlmIndex];
        const selected = document.querySelector('input[name="quiz"]:checked');
        const feedback = document.getElementById('quiz-feedback');
        if(!selected){ feedback.innerText='Select an option'; return;}
        const val = Number(selected.value);
        if(val === slm.quiz.answerIndex){
          feedback.innerText = 'Correct! Badge unlocked.';
          // award badge in localStorage
          const badges = JSON.parse(localStorage.getItem('badges_v1')||'[]');
          if(!badges.includes(slm.quiz.badge)){
            badges.push(slm.quiz.badge);
            localStorage.setItem('badges_v1', JSON.stringify(badges));
            document.getElementById('badge-slot').style.display='inline-block';
          }
        } else {
          feedback.innerText = 'Not quite ‚Äî review the module and try again.';
        }
      }
    });

    // UI wiring
    document.getElementById('start-first-week').addEventListener('click', ()=>{
      // open first in pathway
      const firstId = FIRST_WEEK_PATH[0];
      showSlmById(firstId);
      window.scrollTo({top:0,behavior:'smooth'});
    });
    document.getElementById('view-hacks').addEventListener('click', ()=> {
      document.getElementById('hacks-list').scrollIntoView({behavior:'smooth'});
    });
    document.getElementById('submit-hack').addEventListener('click', ()=> {
      const val = document.getElementById('hack-input').value.trim();
      if(!val) return alert('Enter a short tip');
      const hacks = loadHacks();
      hacks.unshift(val);
      localStorage.setItem('hacks_v1', JSON.stringify(hacks.slice(0,30)));
      document.getElementById('hack-input').value='';
      renderHacks();
    });

    // next/prev/cache/open-map-from-slm buttons
    document.getElementById('next-slm').addEventListener('click', nextSlm);
    document.getElementById('prev-slm').addEventListener('click', prevSlm);
    document.getElementById('cache-this').addEventListener('click', ()=> {
      // mark current SLM cached in localStorage
      const slm = SLMs[currentSlmIndex];
      const cached = JSON.parse(localStorage.getItem('cached_slms_v1')||'{}');
      cached[slm.id] = slm;
      localStorage.setItem('cached_slms_v1', JSON.stringify(cached));
      alert('SLM cached for offline use');
    });
    document.getElementById('open-map-from-slm').addEventListener('click', ()=> {
      // try to open map with a query param indicating nearest help point (if any)
      const slm = SLMs[currentSlmIndex];
      const url = 'map.html?focus=' + encodeURIComponent(slm.id);
      window.location.href = url;
    });

    // Open map button
    document.getElementById('open-map').addEventListener('click', ()=> window.location.href='map.html');

    // attach click handlers for "Open" buttons in pathway via event delegation
    document.addEventListener('click', function(e){
      if(e.target && e.target.classList.contains('view-slm')){
        showSlmById(e.target.dataset.id);
      }
    });

    // show any existing badge
    const badges = JSON.parse(localStorage.getItem('badges_v1')||'[]');
    if(badges.length) document.getElementById('badge-slot').style.display='inline-block';

    // initial render
    (function init(){
      renderPathway();
      renderHacks();
      renderMentors();
      // detect if cached slms exist and pre-load them
      try {
        const cached = JSON.parse(localStorage.getItem('cached_slms_v1')||'{}');
        for(const k in cached) {
          // optionally merge into SLMs if not present
          if(!SLMs.find(s=>s.id===k)) SLMs.push(cached[k]);
        }
      } catch(e){}
    })();

    // Register service worker for caching static assets & offline behavior
    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('sw.js').catch(()=>{ console.log('SW registration failed'); });
    }

  </script>
</body>
</html>
